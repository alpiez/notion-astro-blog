---
import { isFullBlock } from "@notionhq/client";
import Paragraph from "./notion_blocks/paragraph.astro";
import Heading1 from "./notion_blocks/heading_1.astro";
import Heading2 from "./notion_blocks/heading_2.astro";
import Heading3 from "./notion_blocks/heading_3.astro";
import BulletedList from "./notion_blocks/bulleted_list.astro";
import NumberedList from "./notion_blocks/numbered_list.astro";
import type { Content } from "../lib/search_slug";

interface Props {
  contents: Array<Content>;
}

// For bullet list count
let bulletCount = 1;

const { contents } = Astro.props;
---

<>
  {
    contents.map((content) => {
      if (content != undefined && isFullBlock(content.result)) {
        // Reset bullet list count if the block is no longer bullet list
        if (content.result.type != "numbered_list_item" && bulletCount > 1)
          bulletCount = 1;

        // Pick suitable component based on its notion block type
        switch (content.result.type) {
          case "paragraph":
            return <Paragraph content={content} />;
          case "heading_1":
            return <Heading1 content={content} />;
          case "heading_2":
            return <Heading2 content={content} />;
          case "heading_3":
            return <Heading3 content={content} />;
          case "bulleted_list_item":
            return <BulletedList content={content} />;
          case "numbered_list_item":
            return <NumberedList content={content} count={bulletCount++} />;
          default:
            "";
        }
      }
    })
  }
</>
